<!--Creo que primordialmente, este html se usaria para lo que apareceria en todas las paginas-->
{% load static %}
<!DOCTYPE html>
<html lang="en">



<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=, initial-scale=1.0">    
    <link rel="icon" type="image/x-icon" href="{% static 'images/favicon.ico' %}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="{% static 'css/home_index.css' %}">
    <link rel="stylesheet" href="{% static 'css/home.css' %}">
    <link rel="stylesheet" href="{% static 'css/about.css' %}">
    <link rel="stylesheet" href="{% static 'css/profile.css' %}">
    <link rel="stylesheet" href="{% static 'css/deleteacc.css' %}">
    <!--TITULO-->
    <title>{% block title %} {% endblock title %}</title>
</head>

<body class="st-homeidx-body">       
  <!-- BARRA NEGRA-->
  <nav class="navbar navbar-expand-lg bg-black" data-bs-theme="dark">
    <div class="container-fluid">
      <!-- LOGO?-->
        <img class=st-homeidx-logobutton src="{% static 'images/logos/piwit_logo_v1_50px.png'%}"
          aria-current="page"
          style="cursor: pointer;"
          hx-get="{%url 'home'%}"
          hx-target="#main-content"
          hx-select="#page-content"
          hx-swap="morphdom"
          hx-push-url="true">
        </img>
        
      <!--ICONO PARA EXPANDIR RESPONSIVO-->
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <!-- BUTTON 1 - PERFIL -->
          <li class="nav-item">
            <button class="nav-link active"
            aria-current="page"
            hx-get="{%url 'profile'%}"
            hx-target="#main-content"
            hx-select="#page-content"
            hx-swap="morphdom"
            hx-push-url="true">
            Perfil</button>
          </li>

          <!-- BUTTON 2 - AJUSTES-->
          <li class="nav-item">
            <a class="nav-link active" href="{%url 'about' %}"> Acerca de</a>
          </li>
  
          <!-- DROPDOWN - SELECCIONAR TEMA-->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle active" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Temas
            </a>

            <ul class="dropdown-menu" id="theme-dropdown">
              <li>
                <button class="dropdown-item"
                href="#"
                id="theme1"
                data-tema="tema-azul">
                Tema 1</button>
              </li>
              <li>
                <button class="dropdown-item"
                href="#"
                id="theme2"
                data-tema="tema-rosa">
                Tema 2</button>
              </li>
              <!--<li>
                <hr class="dropdown-divider">
              </li>--><!-- Divisor-->
              <li>
                <button class="dropdown-item"
                href="#"
                id="theme3"
                data-tema="tema-verde">
                Tema 3</button>
              </li>
              <li>
                <button class="dropdown-item"
                href="#"
                id="theme4"
                data-tema="tema-retro">
                Tema 4</button>
              </li>
            </ul>
          </li>



          <!-- DROPDOWN - SELECCIONAR AUDIO-->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle active" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Sonido
            </a>

            <ul class="dropdown-menu" id="whitenoise-dropdown">
              <li>
                <a class="dropdown-item"
                href="#"
                id="whitenoise1"
                data-track="audioplayer_audio001_space"
                data-type="audio/mpeg">
                Espacio</a>
              </li>
              <li>
                <a class="dropdown-item"
                href="#"
                id="whitenoise2"
                data-track="audioplayer_audio002_rain"
                data-type="audio/mpeg">
                Lluvia</a>
              </li>
              <!--<li>
                <hr class="dropdown-divider">
              </li>--><!-- Divisor-->
              <li>
                <a class="dropdown-item"
                href="#"
                id="whitenoise3"
                data-track="audioplayer_audio003_sea"
                data-type="audio/mpeg">
                Oceano</a>
              </li>
            </ul>
          </li>


          
          <!-- Reproductor de audio -->
          <audio id="audioplayer" loop>
            <source src="{% static 'sfx/audioplayer_audio001_space.mp3' %}" type="audio/mpeg">
            <source src="{% static 'sfx/audioplayer_audio001_space.ogg' %}" type="audio/ogg">
            <source src="{% static 'sfx/audioplayer_audio001_space.wav' %}" type="audio/wav">
            Tu navegador no soporta audio.
          </audio>



          <li class="nav-item">
              <div>
                  <button class="nav-link active" id="audio_toggle_play_button">▶ / ⏹</button>
              </div>
          </li>
          <li class="nav-item">
              <div>
                  <input class="nav-link active" type="range" id="audio_volume_slider" min="0" max="1" step="0.05" value="1">
              </div>
          </li>



          <!-- DISABLED-->
          <!--<li class="nav-item">
            <a class="nav-link disabled" aria-disabled="true">Disabled</a>
          </li>-->

        </ul>
        <!-- Barra de busqueda-->
        <!--<form class="d-flex" role="search">
          <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search"/>
          <button class="btn btn-outline-success" type="submit">BUSCAR</button>
        </form>-->

      </div>
    </div>
  </nav>

  <main id="main-content">
      {% block content %}
      {% block extra_css %}{% endblock %}
      {% endblock %}
  </main>

    <!-- MODAL -->
    <div class="modal fade" id="editProfileModal" tabindex="-1" aria-labelledby="editProfileModalLabel" hx-preserve>
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">

        <div class="modal-header">
          <h5 class="modal-title" id="editProfileModalLabel">Editar Perfil</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>

        <div class="modal-body">
          <form method="POST" action="{% url 'profile' %}">
            {% csrf_token %}

            <!-- Username -->
            <div class="mb-3 text-start">
              <label class="form-label">Usuario</label>
              <input type="text" name="username" value="{{ request.user.username }}" class="form-control" placeholder="Usuario">
            </div>

            <!-- Email -->
            <div class="mb-3 text-start">
              <label class="form-label">Correo</label>
              <input type="email" name="email" value="{{ request.user.email }}" class="form-control" placeholder="Correo">
            </div>

            <hr>

            <h5 class="text-start mt-3">Cambiar contraseña (opcional)</h5>

            <!-- Contraseña actual -->
            <div class="mb-3 text-start">
              <label class="form-label">Contraseña actual</label>
              <input type="password" name="old_password" class="form-control" placeholder="Actual">
            </div>

            <!-- Nueva contraseña -->
            <div class="mb-3 text-start">
              <label class="form-label">Nueva contraseña</label>
              <input type="password" name="new_password" class="form-control" placeholder="Nueva">
            </div>

            <!-- Confirmar nueva contraseña -->
            <div class="mb-3 text-start">
              <label class="form-label">Confirmar nueva contraseña</label>
              <input type="password" name="new_password2" class="form-control" placeholder="Confirmar nueva">
            </div>

            <button type="submit" class="btn btn-primary w-100">Guardar cambios</button>
          </form>
        </div>

      </div>
    </div>

  </div>


<script src="https://unpkg.com/htmx.org@1.9.10"></script> <!-- SCRIPT PARA HTMX-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script><!-- IMPORTANTE-->
<script src="{% static 'js/audioplayer.js' %}"></script> <!--SCRIPT PARA REPRODUCTOR DE AUDIO-->
<script src="{% static 'js/dropdowniframe.js' %}"></script> <!--SCRIPT PARA IFRAMES-->
<script src="{% static 'js/timer.js' %}"></script> <!--SCRIPT PARA POMODORO-->
<script>
document.addEventListener("DOMContentLoaded", StartDropdown);
document.body.addEventListener("htmx:afterSwap", StartDropdown);
</script>



<script>
document.addEventListener("DOMContentLoaded", () => {
  const body = document.body;
  const botonesTema = document.querySelectorAll("#theme-dropdown .dropdown-item");

  const temaGuardado = localStorage.getItem("tema-activo");
  if (temaGuardado) {
    body.classList.add(temaGuardado);
  } else {
    body.classList.add("tema-1"); 
  }

  botonesTema.forEach(boton => {
    boton.addEventListener("click", () => {
      body.classList.remove("tema-1", "tema-2", "tema-3", "tema-4");

      const texto = boton.textContent.trim().toLowerCase();
      let temaSeleccionado = "";

      if (texto.includes("1")) temaSeleccionado = "tema-1";
      else if (texto.includes("2")) temaSeleccionado = "tema-2";
      else if (texto.includes("3")) temaSeleccionado = "tema-3";
      else if (texto.includes("4")) temaSeleccionado = "tema-4";

      body.classList.add(temaSeleccionado);
      localStorage.setItem("tema-activo", temaSeleccionado);
    });
  });
});
</script>



<script>
document.body.addEventListener('htmx:afterSwap', () => {
  const temaGuardado = localStorage.getItem("tema-activo");
  if (temaGuardado) {
    document.body.classList.remove("tema-1", "tema-2", "tema-3", "tema-4");
    document.body.classList.add(temaGuardado);
  }
});
</script>

<script>
document.body.addEventListener("htmx:configRequest", (event) => {
    event.detail.headers["X-CSRFToken"] = "{{ csrf_token }}";
});
</script>



<div id="modal-container"></div>
</body>
{% block extra_js %}{% endblock %}
</html>
<!--
        <div class="d-flex flex-column justify-content-center align-items-center">
          <h1 class="mt-4 mb-4"><a href="/">LOGO</a></h1>
          Personaliza a tu manera!
        </div>
-->